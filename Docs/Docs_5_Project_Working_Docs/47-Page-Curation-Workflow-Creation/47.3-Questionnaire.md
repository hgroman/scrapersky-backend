# Questionnaire for `pages` Table CRUD Implementation

This document lists the questions and prerequisites identified from the initial CRUD specification draft (`47.2-CRUD-Specification-for-pages.table.md`) and subsequent analysis/decisions.

**Answers derived from `pages_rows.csv`, code inspection, workflow YAML analysis, and user decisions as of 2025-05-05.**

## I. Database Schema (`pages` table)

1.  **Model Path:** What is the exact file path for the `Page` SQLAlchemy model? **Answer (Code Inspection): Yes, the model exists at `src/models/page.py`.**
2.  **Primary Curation Status Column:**
    - Does a column for primary curation status exist? **Answer (from CSV): No.**
    - **Action:** Add column named `page_curation_status`. Type: DB Enum linked to `PageCurationStatus`.
3.  **Secondary Processing Status Column (Dual-Status):**
    - Does a column for secondary processing status exist? **Answer (from CSV): No.**
    - **Action:** Add column named `page_processing_status`. Type: DB Enum linked to `PageProcessingStatus`.
4.  **Error Column:**
    - Does a column to store processing errors exist? **Answer (from CSV): No.**
    - **Action:** Add column named `page_processing_error`. Type: Text/String, nullable.
5.  **Tenant ID Column:** Confirm the `pages` table has a `tenant_id` column (UUID). **Answer (from CSV): Yes, `tenant_id` exists.**
6.  **Other Fields:** Verify the existence and exact names of other necessary fields like `sitemap_file_id`, `url`, `created_at`, `updated_at`. **Answer (from CSV): Yes, `sitemap_file_id`, `url`, `created_at`, `updated_at` exist.**

## II. Enum Definitions

7.  **Primary Curation Status Enum (`PageCurationStatus`):**
    - **Action:** Define **new Enum** named `PageCurationStatus` (Location: `src/models/page.py` or `src/models/enums.py`).
    - Required members/values: `New`, `Selected`, `Rejected`, `Archived` (Confirmed).
8.  **Secondary Processing Status Enum (`PageProcessingStatus`):**
    - **Action:** Define **new Enum** named `PageProcessingStatus` (Location: `src/models/page.py` or `src/models/enums.py`).
    - Required members/values: `Queued`, `Processing`, `Completed`, `Error` (Confirmed).
9.  **API Status Enum(s):**
    - **Action:** Create corresponding **new API Enums** in `src/models/api_models.py` (e.g., `PageApiCurationStatusEnum`, `PageApiProcessingStatusEnum`).

## III. API and Pydantic Models

10. **Sortable Fields:** Define the specific list of `pages` table fields allowed for sorting. **Answer:** `url`, `page_curation_status`, `page_processing_status`, `created_at`, `updated_at` (Confirmed).
11. **Pydantic Models:**
    - **Action:** Define required Pydantic models (likely in `src/models/api_models.py` or `src/schemas/page.py`):
      - `PageRecord`: Structure for single page item in list response.
      - `PaginatedPageResponse`: Structure for the paginated list response.
      - `PageBatchStatusUpdateRequest`: Structure for the `PUT /status` request body.
      - API versions of status Enums (as per Q9).

## IV. Prerequisite Tasks Summary

- **Database Modifications:** Create/run Alembic migration for new columns: `page_curation_status` (using new Enum type), `page_processing_status` (using new Enum type), and `page_processing_error`.
- **Enum Creation:** Implement required Python Enums (`PageCurationStatus`, `PageProcessingStatus`) and corresponding API Enums.
- **Pydantic Model Creation:** Implement required Pydantic models (`PageRecord`, `PaginatedPageResponse`, `PageBatchStatusUpdateRequest`).
- **SQLAlchemy Model Update:** Ensure `src/models/page.py` reflects the final schema including new columns/enums.
