# 03: The Data Extraction Mechanism

## Component Overview

This component defines the process and tools required to reliably extract structured data from the markdown documents that define patterns (both problem patterns and good pattern exemplars). This extracted data is then used to populate the Vector DB Knowledge System.

## Purpose

To provide a robust and automated way to translate the human-readable, structured markdown documentation into a machine-readable format suitable for database insertion, bypassing the limitations encountered with direct JSON writing of complex content.

## Key Considerations

*   **Reliability:** The mechanism must accurately parse the markdown structure and extract data from the defined fields, including multi-line text, without errors.
*   **Handling Markdown Structure:** The mechanism needs to understand the specific markdown formatting used in the pattern documents (e.g., headings, lists, code blocks, key-value pairs).
*   **Escaping:** Proper escaping of special characters within the extracted text (especially for fields that will be stored as strings in the database) is crucial.
*   **Output Format:** The output should be in a simple, standardized format that the Vector DB insertion script can easily consume (e.g., a list of dictionaries in JSON format, but generated by this mechanism, not manually written).
*   **Linking to DART:** The mechanism must extract the DART document URLs from the markdown and include them in the output data structure.

## Process

1.  **Identify Source Documents:** The mechanism is provided with the file paths of the markdown pattern documents to process (e.g., all `.md` files in `Docs/Docs_11_Refactor/Layer3_Fix_Patterns/` and similar directories).
2.  **Read Document Content:** The mechanism reads the raw text content of each markdown file.
3.  **Parse Markdown:** The mechanism parses the markdown structure to identify the sections and fields corresponding to the pattern details (Title, Problem Type, Problem Description, Solution Steps, Tags, etc.).
4.  **Extract Data:** Data is extracted from each identified field. Special attention is paid to multi-line text fields, ensuring all content is captured.
5.  **Escape Special Characters:** Special characters within the extracted string data (e.g., double quotes, backslashes, newlines) are properly escaped according to JSON standards.
6.  **Format Output:** The extracted and escaped data for each pattern is formatted into a structured record (e.g., a Python dictionary).
7.  **Compile Output:** The structured records for all processed patterns are compiled into a single output structure (e.g., a list of dictionaries).
8.  **Provide Output:** The compiled output data is made available for the Vector DB insertion script (e.g., written to a temporary, simple JSON file or passed directly if possible).

## Required Outputs

*   A script or tool that takes markdown pattern file paths as input and outputs structured pattern data in a format consumable by the Vector DB insertion script.

## Dependencies

*   The standardized format of the markdown pattern documents.
*   Available tools for reading files (`read_file`).
*   The Vector DB Insertion Script (which defines the required input data format).

## Responsible Role

*   **Architect Persona (Roo):** Designs and develops the Data Extraction Mechanism.

## Notes

Developing this mechanism is critical to overcoming the previous bottleneck. It should be tested thoroughly with various pattern documents to ensure reliability before being used for large-scale knowledge onboarding. This mechanism could potentially be implemented as a Python script utilizing a markdown parsing library.